package org.ebulabs.hotspot;

import java.io.IOException;
import java.net.InetAddress;
import java.net.UnknownHostException;

import javax.jmdns.*;
import javax.jmdns.impl.*;

import android.util.Log;

/** Finds the hotspot using Zeroconf */
public class DiscoverHotspot {
	public DiscoverHotspot() {
		
		class HotspotListener implements ServiceListener
		{
			@Override
			public void serviceAdded(ServiceEvent event) {
				Log.i(Utils.LOGTAG + ".DiscoverHotspot", "serviceAdded");
			}
			
			@Override
			public void serviceRemoved(ServiceEvent event) {
				Log.i(Utils.LOGTAG + ".DiscoverHotspot", "serviceRemoved");
			}
			
			@Override
			public void serviceResolved(ServiceEvent event) {
				Log.i(Utils.LOGTAG + ".DiscoverHotspot", "serviceResolved");
				Log.d(Utils.LOGTAG + ".DiscoverHotspot", event.getInfo().getDomain());
				Log.d(Utils.LOGTAG + ".DiscoverHotspot", event.getInfo().getServer());
				Log.d(Utils.LOGTAG + ".DiscoverHotspot", event.getInfo().getPort());
			}
		}

		JmDNSImpl jmdns;
		try {
			jmdns = new JmDNSImpl(InetAddress.getByName("0.0.0.0"), "AndroidHotspotReceiver");
			jmdns.addServiceListener("_bhcp._tcp.local.", new HotspotListener());
		} catch (Exception e) {
			Log.e(Utils.LOGTAG + ".DiscoverHotspot", "jmdns failed");
			e.printStackTrace();
		} 
		
	}

}



